### 4. Security Side: Using Splunk Enterprise for Monitoring and Alerts

**Step 1: Setting up CentOS Linux on VMware Workstation**

1. **Configuration**: CentOS Linux 7 is installed on VMware Workstation with the following specifications:
   - IP address: 192.168.80.161 (NAT configuration)
   - Memory: 1 GB
   - Processor: 1
   - Hard disk: 50 GB

2. **Objective**: Establish a stable environment for deploying and testing the Splunk SIEM solution to enable effective monitoring and analysis of security events.

   ![CentOS Linux Installed on VMware Workstation](https://github.com/Rollan19/Securing-Networks-By-Leveraging-Splunk/assets/157499734/e34d9378-e542-46fb-bcb5-0d185a40dbd9c)

**Step 2: Activating Network Interface and SSH Access**

1. **Command**: `ifup ens33` - Activates the network interface and obtains an IP address.

2. **Access**: Use Putty to log in to the CentOS virtual machine via SSH using the assigned IP address (192.168.80.161).

   ![Putty through SSH](https://github.com/Rollan19/Securing-Networks-By-Leveraging-Splunk/assets/157499734/38591fd8-284c-4ac4-84d9-3c422134848d)

**Step 3: Creating a Root User Account**

1. **Account Creation**: Create a root user account named 'lunar' with password 'LNar19@' and add it to the wheel group for elevated privileges using the 'sudo' command.

   ![Creating a root user account](https://github.com/Rollan19/Securing-Networks-By-Leveraging-Splunk/assets/157499734/3b41f89e-cb10-4920-98ec-48a4def96443)

2. **Verification**: Check the 'lunar' account under the 'home' directory.

   ![Checking 'lunar' account](https://github.com/Rollan19/Securing-Networks-By-Leveraging-Splunk/assets/157499734/21e3b293-30f5-49c0-ae08-3e81c9d0c97c)

3. **Exploitable Files**: Create directories "Personal_Doc" and "Client_Projects" with sensitive files for monitoring.

   ![Exploitable files](https://github.com/Rollan19/Securing-Networks-By-Leveraging-Splunk/assets/157499734/a98c89d2-4292-4a58-b3f5-d3b3e7d5b486)

**Step 4: Installing Splunk Enterprise**

1. **Download**: Copy the Splunk Enterprise download link from the Splunk website.

   ![Copying Splunk download link](https://github.com/Rollan19/Securing-Networks-By-Leveraging-Splunk/assets/157499734/fd69998c-87bc-4917-a521-1adfe9f3d09f)

2. **Installation**: Use the `wget` command to download and install Splunk Enterprise.

   ![Installing Splunk](https://github.com/Rollan19/Securing-Networks-By-Leveraging-Splunk/assets/157499734/6fd9b533-de00-49b5-bdf3-d92a82cdd584)

   ![Checking the downloaded file](https://github.com/Rollan19/Securing-Networks-By-Leveraging-Splunk/assets/157499734/5ea311a1-6bc8-4096-8525-5818b589335a)

   ![After unzipping the tar file](https://github.com/Rollan19/Securing-Networks-By-Leveraging-Splunk/assets/157499734/0793fb9a-22ef-4503-a762-afeab10a7e14)

3. **Activation**: Start Splunk Enterprise and accept the license agreement.

   ![Activation of Splunk](https://github.com/Rollan19/Securing-Networks-By-Leveraging-Splunk/assets/157499734/b1fd705c-23e6-4417-802f-f176c57bf316)

   ![Running Splunk](https://github.com/Rollan19/Securing-Networks-By-Leveraging-Splunk/assets/157499734/ad12ca72-d976-4d2b-a6de-672eef6311be)

**Step 5: Configuring Splunk for Monitoring**

1. **Access Splunk**: Log in to the Splunk Enterprise web interface.

   ![Splunk Enterprise login](https://github.com/Rollan19/Securing-Networks-By-Leveraging-Splunk/assets/157499734/7eed21fc-bf38-4e0e-98af-0e00ede6f204)

2. **Interface**: Explore the Splunk Enterprise dashboard.

   ![Splunk Enterprise interface](https://github.com/Rollan19/Securing-Networks-By-Leveraging-Splunk/assets/157499734/58501df0-a8ad-4b18-acd8-58f666d48e86)

3. **Add Data**: Use the command `/opt/splunk/bin/splunk add monitor /var/log` to add the `/var/log` directory to Splunk's real-time monitoring.

   ![Adding data to Splunk](https://github.com/Rollan19/Securing-Networks-By-Leveraging-Splunk/assets/157499734/a1326940-1cce-40f0-92ca-e372860c8064)

4. **Verify Data Input**: Check the monitoring data in Splunk's Data Summary.

   ![Checking the monitoring data](https://github.com/Rollan19/Securing-Networks-By-Leveraging-Splunk/assets/157499734/04f5aca7-9a1e-4c12-b6b6-18921641d173)

   ![Data sources in Splunk](https://github.com/Rollan19/Securing-Networks-By-Leveraging-Splunk/assets/157499734/b2eb20f0-a962-4f01-a3da-e20d4c7668b0)

**Step 6: Configuring Alerts in Splunk**

1. **Dashboard**: Configure alerts based on various security events.

   ![Alerts](https://github.com/Rollan19/Securing-Networks-By-Leveraging-Splunk/assets/157499734/bbfa50b5-2660-46f8-8b14-866b09a09e22)

2. **Brute Force Attack Alert**: 
   - Search Query:
     ```spl
     index=_audit action="failed" host="localhost.localdomain" "/var/log/audit/audit.log"
     ```
   - Trigger Conditions: More than five failed login attempts within one minute.

     ![Brute Force Attack alerts](https://github.com/Rollan19/Securing-Networks-By-Leveraging-Splunk/assets/157499734/64570252-f799-42fb-9514-5a82288da02c)

     ![Configuration of Brute Force Attack alert](https://github.com/Rollan19/Securing-Networks-By-Leveraging-Splunk/assets/157499734/1437e9a7-ee8b-42cf-84e2-1c4417934d31)

     ![Configuration of Brute Force Attack alert](https://github.com/Rollan19/Securing-Networks-By-Leveraging-Splunk/assets/157499734/91a08445-b97f-4961-b597-138bc3b96436)

3. **External Login Attempt Alert**:
   - Search Query:
     ```spl
     index=_secure action="accepted" host="localhost.localdomain" "/var/log/secure" sshd
     ```
   - Trigger Conditions: Each event matching the search query.

     ![External Login Attempt alerts](https://github.com/Rollan19/Securing-Networks-By-Leveraging-Splunk/assets/157499734/1de2bd61-d4bf-4ce2-b021-3d24e8394d39)

     ![Configuration of External Login Attempt alert](https://github.com/Rollan19/Securing-Networks-By-Leveraging-Splunk/assets/157499734/6d721e9a-bfe6-46c3-9b17-ff0a4bb7aa9f)

     ![Configuration of External Login Attempt alert](https://github.com/Rollan19/Securing-Networks-By-Leveraging-Splunk/assets/157499734/4be8ddf9-76eb-4810-955c-da0434abdba7)

4. **File Transfer via SSH Alert**:
   - Search Query:
     ```spl
     index=_audit action="/usr/libexec/openssh/sftp-server" host="localhost.localdomain" "/var/log/audit/audit.log"
     ```
   - Trigger Conditions:

 Each event matching the search query.

     ![File Transfer via SSH alerts](https://github.com/Rollan19/Securing-Networks-By-Leveraging-Splunk/assets/157499734/b6a240e2-d5ac-4290-9aa8-79f30f47cbd8)

     ![Configuration of File Transfer via SSH alert](https://github.com/Rollan19/Securing-Networks-By-Leveraging-Splunk/assets/157499734/f5ff86e7-47c5-45eb-8ef1-8be3f73e7a3d)

     ![Configuration of File Transfer via SSH alert](https://github.com/Rollan19/Securing-Networks-By-Leveraging-Splunk/assets/157499734/5ba3f9f5-d115-45c0-8e29-2fbc1e6b6d07)

### Conclusion

Using Splunk Enterprise, we successfully created a SIEM solution to monitor and generate alerts for various security events, enhancing network security and providing valuable insights for incident response.
